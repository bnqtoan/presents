<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Command Center - Master 8.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Custom Animations */
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
        }
        .animate-pulse-glow { animation: pulse-glow 2s infinite; }
        
        /* Glassmorphism */
        .glass {
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tech-mode-bg { background: rgba(15, 23, 42, 0.85); }
        .sales-mode-bg { background: rgba(6, 78, 59, 0.85); }

        .theme-transition { transition: all 0.8s ease-in-out; }
        
        /* Obsidian Button Hover */
        .obsidian-btn:hover {
            box-shadow: 0 0 15px #a855f7;
            transform: translateY(-1px);
        }
    </style>
</head>
<body class="overflow-x-hidden theme-transition min-h-screen text-slate-100 bg-slate-900">

    <!-- Background Layer -->
    <div id="bg-container" class="fixed inset-0 z-0 theme-transition transform scale-105">
        <div id="bg-image" class="absolute inset-0 bg-cover bg-center theme-transition duration-1000 opacity-60"></div>
        <div id="bg-overlay" class="absolute inset-0 theme-transition duration-1000 bg-slate-900/80"></div>
    </div>

    <!-- Canvas Layers -->
    <canvas id="star-canvas" class="fixed inset-0 pointer-events-none z-0 opacity-50"></canvas>
    <canvas id="confetti-canvas" class="fixed inset-0 pointer-events-none z-50"></canvas>

    <!-- Main Content -->
    <div class="relative z-10 max-w-4xl mx-auto p-4 md:p-8 min-h-screen flex flex-col">
        
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-6 gap-6">
            
            <!-- Identity -->
            <div class="flex items-center gap-4 w-full md:w-auto">
                <div class="relative group cursor-pointer">
                    <div id="avatar-glow" class="absolute inset-0 rounded-full blur-md opacity-50 bg-indigo-500 animate-pulse"></div>
                    <img src="https://uploads.aigency.asia/ab6b3ca8-5607-432b-8d33-a96775eac710.jpeg" 
                         alt="User Avatar" 
                         class="w-16 h-16 md:w-20 md:h-20 rounded-full border-2 border-white/20 relative z-10 object-cover shadow-xl transition-transform transform group-hover:scale-105">
                </div>
                <div>
                    <h1 class="text-2xl md:text-3xl font-black tracking-tight drop-shadow-sm flex items-center gap-2">
                        <span id="header-title" class="bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-400">
                            AI MASTER
                        </span>
                        <span class="text-white">HQ</span>
                    </h1>
                    <p class="text-xs md:text-sm font-medium text-slate-400 font-mono">
                        Target: IELTS 8.0 & Tech Sales Mastery
                    </p>
                </div>
            </div>

            <!-- Big Clock -->
            <div class="text-center md:text-right">
                <div id="clock-time" class="text-4xl md:text-6xl font-black tracking-tighter tabular-nums leading-none text-white drop-shadow-lg">00:00</div>
                <div id="clock-date" class="text-xs md:text-sm font-medium uppercase tracking-widest mt-1 opacity-80 text-indigo-400">Monday, Jan 1</div>
            </div>
        </header>

        <!-- Stats & Mode Panel -->
        <div class="flex justify-between items-end mb-4">
            <!-- Mode Indicator -->
            <div id="mode-badge" class="px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wider backdrop-blur-md border shadow-lg flex items-center gap-2 transition-all duration-500">
                <i data-lucide="loader" class="animate-spin w-3 h-3"></i> Detecting Protocol...
            </div>

            <div id="stats-panel" class="flex items-center gap-2 p-1.5 rounded-lg border border-white/10 shadow-sm backdrop-blur-md bg-white/5">
                <div class="px-3 border-r border-white/10 text-center">
                   <div class="text-[9px] uppercase font-bold opacity-60 text-slate-300">Level</div>
                   <div id="level-display" class="font-bold text-indigo-400 text-lg leading-none">1</div>
                </div>
                <div class="px-3 text-center">
                   <div class="text-[9px] uppercase font-bold opacity-60 text-slate-300">XP</div>
                   <div id="xp-display" class="font-bold text-green-400 text-lg leading-none">0</div>
                </div>
                <button onclick="resetDay()" class="p-1.5 hover:bg-white/10 rounded-md transition-colors ml-1" title="Reset Day">
                   <i data-lucide="refresh-cw" class="w-4 h-4 text-slate-400"></i>
                </button>
           </div>
        </div>

        <!-- Progress Bar -->
        <div class="w-full h-2 bg-slate-700/50 rounded-full overflow-hidden mb-8 relative">
            <div id="progress-fill" class="h-full transition-all duration-700 ease-out bg-gradient-to-r from-indigo-500 to-purple-500 w-0"></div>
        </div>

        <!-- Day Timeline Ruler -->
        <div id="timeline-container" class="w-full mb-8 p-4 rounded-xl backdrop-blur-md border border-white/10 shadow-sm transition-colors duration-500 bg-slate-800/40">
            <div class="flex justify-between items-center mb-2">
                <span class="text-[10px] uppercase font-bold tracking-wider flex items-center gap-1 text-indigo-400">
                   <i data-lucide="activity" class="w-3 h-3"></i> Timeline
                </span>
                <span id="timeline-pct" class="font-mono text-xs font-bold text-slate-400">0%</span>
            </div>
            <div class="relative h-6 w-full select-none" id="timeline-track-container">
                <!-- Track -->
                <div class="absolute top-3 left-0 right-0 h-1 rounded-full bg-slate-600/30"></div>
                <!-- Needle -->
                <div id="timeline-needle" class="absolute top-0 bottom-0 w-0.5 bg-red-500 z-20 shadow-[0_0_10px_rgba(239,68,68,0.8)] transition-all duration-1000 left-0">
                    <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-red-500 text-white text-[8px] font-bold px-1 rounded-sm whitespace-nowrap">NOW</div>
                </div>
            </div>
        </div>

        <!-- Focus Highlight (Dynamic) -->
        <div id="focus-container"></div>

        <!-- Task List -->
        <div id="task-list" class="space-y-4 pl-2 transition-opacity duration-500">
            <!-- Tasks injected by JS -->
        </div>

    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- CONFIG & DATA ---
        const BG_IMAGES = {
            tech: "https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=2070&auto=format&fit=crop", // Tech/Chip
            sales: "https://images.unsplash.com/photo-1507679799987-c73779587ccf?q=80&w=2071&auto=format&fit=crop" // Business/People
        };

        // Determine Mode: Even Day = Tech (AI Research), Odd Day = Sales
        const today = new Date().getDate();
        const isTechDay = today % 2 === 0;
        
        const MODE_CONFIG = isTechDay 
            ? { 
                name: "HARDCORE TECH DAY", 
                sub: "AI Research & Deep Tech",
                color: "text-cyan-400", 
                bg: "bg-cyan-900/40 border-cyan-500/50",
                icon: "cpu"
              }
            : { 
                name: "SALES & PSYCHOLOGY DAY", 
                sub: "Persuasion & Human Behavior",
                color: "text-emerald-400", 
                bg: "bg-emerald-900/40 border-emerald-500/50",
                icon: "users"
              };

        const INITIAL_SCHEDULE = [
            // Morning Slot: Dynamic based on Tech vs Sales day
            { 
                id: 'morning-1', 
                start: "09:15", 
                end: "09:45", 
                type: isTechDay ? "Research Reading" : "Sales Reading", 
                title: isTechDay ? "Arxiv Paper Analysis" : "Sales Psychology (Deep Work)", 
                gem: isTechDay ? "Gem: Arxiv Deconstructor" : "Gem: Arxiv Deconstructor (Adapted)",
                icon: "book-open", 
                color: isTechDay ? "bg-cyan-500" : "bg-emerald-500", 
                userTask: isTechDay ? "Read 'Attention Is All You Need' or latest LLM paper. Translate structure mentally." : "Read 'Thinking Fast & Slow'. Highlight C1 behavioral terms.", 
                aiTask: isTechDay ? "Analyze syntax. Extract academic collocations." : "Explain these terms in IELTS Speaking context." 
            },
            { 
                id: 'morning-2', 
                start: "09:45", 
                end: "10:30", 
                type: "Listening Input", 
                title: isTechDay ? "Tech Lecture (Karpathy/Lex)" : "Sales Shadowing (Steve Jobs)", 
                gem: isTechDay ? "Obsidian: Smart Notes" : "Gem: Pitch Trainer",
                icon: "headphones", 
                color: isTechDay ? "bg-cyan-600" : "bg-emerald-600", 
                userTask: isTechDay ? "Active note-taking. Focus on technical argumentation flow." : "Shadowing & Dictation. Copy intonation exactly.", 
                aiTask: isTechDay ? "Summarize key technical points into Bullet points." : "Check transcription accuracy." 
            },
            { 
                id: 'morning-3', 
                start: "10:30", 
                end: "11:15", 
                type: "Output Mastery", 
                title: isTechDay ? "Tech Speaking / Writing" : "Persuasive Speaking", 
                gem: isTechDay ? "Gem: The Tech Interviewer" : "Gem: The Feynman Salesman",
                icon: "mic", 
                color: isTechDay ? "bg-cyan-700" : "bg-emerald-700", 
                userTask: isTechDay ? "Answer abstract questions about AI Future (Part 3 style)." : "Explain a tech concept to a non-tech CEO.", 
                aiTask: isTechDay ? "Critique Lexical Resource (Tech) & Structure." : "Rate Analogy Score (1-10)." 
            },
            
            { id: 'break-1', isBreak: true, start: "11:15", end: "11:30", title: "Break - Screen Off", duration: "15m" },
            
            { id: 'main-1', start: "11:30", end: "13:00", type: "Build", title: "Deep Work: Product Core", icon: "code", color: "bg-indigo-600", userTask: "Code core features, complex logic, architecture decisions.", aiTask: "Refactor code, Write Unit Tests, Dummy Data." },
            
            { id: 'break-2', isBreak: true, start: "13:00", end: "14:00", title: "Lunch & Rest", duration: "60m" },
            
            { id: 'afternoon-1', start: "14:00", end: "16:00", type: "Money", title: "Marketing & Community", icon: "share-2", color: "bg-green-600", userTask: "Create 'Big Idea', emotional stories, interaction.", aiTask: "Clone content formats (Post -> Mail -> Video Script)." },
            { id: 'afternoon-2', start: "16:00", end: "17:30", type: "Asset", title: "Course / Knowledge Graph", gem: "Obsidian Sync", icon: "database", color: "bg-purple-600", userTask: "Consolidate Research Notes -> Course Syllabus.", aiTask: "Transcribe audio -> Structure into Obsidian." },
            
            { id: 'break-3', isBreak: true, start: "17:30", end: "21:00", title: "Family / Sport / Dinner", duration: "3.5h" },
            
            { id: 'night-1', start: "21:00", end: "22:00", type: "Network", title: "Networking & Research", icon: "search", color: "bg-orange-500", userTask: "Strategy to approach VIPs. Personalized emails.", aiTask: "Research partner profiles (LinkedIn/FB)." },
            { id: 'night-2', start: "22:45", end: "23:00", type: "Plan", title: "Wrap up & Plan", icon: "check-circle-2", color: "bg-slate-500", userTask: "Review 3 wins. List 3 tasks for tomorrow.", aiTask: "No AI." }
        ];

        // --- STATE & DOM ---
        let schedule = JSON.parse(localStorage.getItem('ai_schedule_v2')) || JSON.parse(JSON.stringify(INITIAL_SCHEDULE));
        
        const bgImage = document.getElementById('bg-image');
        const clockTime = document.getElementById('clock-time');
        const clockDate = document.getElementById('clock-date');
        const taskList = document.getElementById('task-list');
        const focusContainer = document.getElementById('focus-container');
        const progressBar = document.getElementById('progress-fill');
        const timelineNeedle = document.getElementById('timeline-needle');
        const timelinePct = document.getElementById('timeline-pct');
        const levelDisplay = document.getElementById('level-display');
        const xpDisplay = document.getElementById('xp-display');
        const modeBadge = document.getElementById('mode-badge');

        // --- LOGIC ---
        function init() {
            // Apply Theme
            document.body.className = isTechDay 
                ? "overflow-x-hidden theme-transition min-h-screen text-slate-100 bg-slate-900 selection:bg-cyan-500/30"
                : "overflow-x-hidden theme-transition min-h-screen text-slate-100 bg-slate-900 selection:bg-emerald-500/30";

            bgImage.style.backgroundImage = `url('${isTechDay ? BG_IMAGES.tech : BG_IMAGES.sales}')`;
            
            // Set Mode Badge
            modeBadge.innerHTML = `<i data-lucide="${MODE_CONFIG.icon}" class="w-4 h-4"></i> <div>${MODE_CONFIG.name}<div class="text-[9px] font-normal opacity-70">${MODE_CONFIG.sub}</div></div>`;
            modeBadge.className = `px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wider backdrop-blur-md border shadow-lg flex items-center gap-3 transition-all duration-500 ${MODE_CONFIG.color} ${MODE_CONFIG.bg}`;

            updateTime();
            setInterval(updateTime, 1000 * 60);
            renderSchedule();
            initStarField();
            lucide.createIcons();
        }

        function updateTime() {
            const now = new Date();
            clockTime.innerText = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            clockDate.innerText = now.toLocaleDateString([], { weekday: 'long', day: 'numeric', month: 'short' });
            updateTimeline(now);
        }

        function updateTimeline(now) {
            const START_HOUR = 9; 
            const END_HOUR = 23; 
            const totalMinutes = (END_HOUR - START_HOUR) * 60;
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            const startMinutes = START_HOUR * 60;
            let percentage = ((currentMinutes - startMinutes) / totalMinutes) * 100;
            percentage = Math.max(0, Math.min(100, percentage));

            timelineNeedle.style.left = `${percentage}%`;
            timelinePct.innerText = `${Math.round(percentage)}%`;
        }

        function toggleTask(id) {
            schedule = schedule.map(item => {
                if (item.id === id) return { ...item, completed: !item.completed };
                return item;
            });
            localStorage.setItem('ai_schedule_v2', JSON.stringify(schedule));
            renderSchedule();
            if(schedule.filter(i => !i.isBreak && i.completed).length === schedule.filter(i => !i.isBreak).length) {
                triggerConfetti();
            }
        }

        function resetDay() {
            if(confirm("Start a new day?")) {
                schedule = JSON.parse(JSON.stringify(INITIAL_SCHEDULE));
                localStorage.setItem('ai_schedule_v2', JSON.stringify(schedule));
                renderSchedule();
            }
        }

        function renderSchedule() {
            const tasksOnly = schedule.filter(i => !i.isBreak);
            const completed = tasksOnly.filter(i => i.completed).length;
            const progress = (completed / tasksOnly.length) * 100;

            progressBar.style.width = `${progress}%`;
            levelDisplay.innerText = progress < 30 ? "1" : progress < 70 ? "2" : "3";
            xpDisplay.innerText = Math.round(progress * 10);

            // Timeline Markers
            const track = document.getElementById('timeline-track-container');
            Array.from(track.children).forEach(c => { if(c.id !== 'timeline-needle' && !c.classList.contains('bg-slate-600/30')) c.remove(); });
            
            // Add blocks to timeline
            schedule.forEach(task => {
                const [sh, sm] = task.start.split(':').map(Number);
                const [eh, em] = task.end.split(':').map(Number);
                const sMins = sh * 60 + sm - 9 * 60;
                const duration = (eh * 60 + em) - (sh * 60 + sm);
                const leftP = (sMins / (14 * 60)) * 100;
                const widthP = (duration / (14 * 60)) * 100;

                if (widthP > 0 && leftP <= 100) {
                    const block = document.createElement('div');
                    block.className = `absolute top-1 h-1.5 rounded-sm opacity-60 ${task.isBreak ? 'bg-slate-600' : (task.color.replace('bg-', 'bg-') || 'bg-slate-400')}`;
                    block.style.left = `${leftP}%`;
                    block.style.width = `${widthP}%`;
                    track.appendChild(block);
                }
            });

            // Focus Card
            const nextTaskIdx = schedule.findIndex(i => !i.isBreak && !i.completed);
            const focusTask = nextTaskIdx !== -1 ? schedule[nextTaskIdx] : null;
            
            if(focusTask) {
                focusContainer.innerHTML = `
                 <div class="mb-8 rounded-xl p-0.5 bg-gradient-to-r from-indigo-500 to-purple-500 shadow-2xl hover:scale-[1.01] transition-transform cursor-pointer" 
                      onclick="document.getElementById('${focusTask.id}')?.scrollIntoView({ behavior: 'smooth', block: 'center' })">
                    <div class="bg-slate-900 rounded-[10px] p-5 relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-12 opacity-10 bg-indigo-500 blur-3xl rounded-full translate-x-10 -translate-y-10"></div>
                        <div class="flex items-start justify-between relative z-10">
                            <div>
                                <div class="flex items-center gap-2 text-indigo-400 text-xs font-bold uppercase tracking-wider mb-1">
                                    <i data-lucide="crosshair" class="w-3.5 h-3.5 animate-pulse"></i> Priority Focus
                                </div>
                                <h2 class="text-xl md:text-2xl font-bold text-white mb-1">${focusTask.title}</h2>
                                <div class="flex items-center gap-2 text-sm text-slate-400 font-mono">
                                    <span>${focusTask.start} - ${focusTask.end}</span>
                                    ${focusTask.gem ? `<span class="px-2 py-0.5 rounded bg-purple-900/50 text-purple-300 text-xs border border-purple-500/30">${focusTask.gem}</span>` : ''}
                                </div>
                            </div>
                            <div class="bg-indigo-500/20 p-3 rounded-lg text-indigo-300">
                                <i data-lucide="${focusTask.icon}" class="w-6 h-6"></i>
                            </div>
                        </div>
                    </div>
                 </div>`;
            } else {
                focusContainer.innerHTML = '';
            }

            // List
            let html = '';
            const renderSection = (title, items) => {
                if(items.length === 0) return;
                html += `<div class="mb-2 mt-6 pl-4 text-xs font-bold uppercase tracking-widest text-slate-500 flex items-center gap-2">
                    <div class="h-px flex-1 bg-slate-800"></div> ${title} <div class="h-px flex-1 bg-slate-800"></div>
                </div>`;
                items.forEach(item => {
                    if (item.isBreak) {
                        html += `
                        <div class="flex items-center gap-4 py-3 opacity-50 hover:opacity-100 transition-opacity px-4 rounded-lg border border-transparent hover:border-slate-700">
                            <span class="font-mono text-xs text-slate-500 w-12 text-right">${item.start}</span>
                            <div class="h-px w-4 bg-slate-700"></div>
                            <i data-lucide="coffee" class="w-4 h-4 text-slate-500"></i>
                            <span class="text-sm font-medium text-slate-400">${item.title}</span>
                        </div>`;
                        return;
                    }
                    
                    const isFocus = focusTask && item.id === focusTask.id;
                    html += `
                    <div id="${item.id}" class="group relative flex gap-4 transition-all duration-300 ${item.completed ? 'opacity-50 grayscale' : ''}" onclick="toggleTask('${item.id}')">
                         <div class="w-12 pt-4 text-right flex-shrink-0">
                            <span class="font-mono text-sm font-bold ${item.completed ? 'text-slate-600 line-through' : (isFocus ? 'text-indigo-400' : 'text-slate-400')}">${item.start}</span>
                         </div>
                         
                         <div class="relative flex-1">
                             <div class="absolute left-[-21px] top-6 w-3 h-3 rounded-full border-2 border-slate-900 ${item.completed ? 'bg-slate-700' : item.color} z-10 shadow-[0_0_0_4px_rgba(15,23,42,1)]"></div>
                             <div class="absolute left-[-16px] top-8 bottom-[-24px] w-px bg-slate-800 group-last:hidden"></div>

                             <div class="rounded-xl border ${isFocus ? 'border-indigo-500/50 bg-indigo-900/10' : 'border-slate-700/50 bg-slate-800/30'} p-4 cursor-pointer hover:bg-slate-800/50 transition-colors backdrop-blur-sm">
                                 <div class="flex justify-between items-start mb-3">
                                     <div class="flex items-center gap-3">
                                         <div class="p-2 rounded-lg ${item.color} bg-opacity-20 text-white shadow-sm">
                                             <i data-lucide="${item.completed ? 'check' : item.icon}" class="w-4 h-4"></i>
                                         </div>
                                         <div>
                                            <h3 class="font-bold text-slate-200 ${item.completed ? 'line-through decoration-slate-600' : ''}">${item.title}</h3>
                                            <div class="text-[10px] uppercase font-bold tracking-wider opacity-60 ${isTechDay ? 'text-cyan-400' : 'text-emerald-400'}">${item.type}</div>
                                         </div>
                                     </div>
                                     ${item.gem ? `
                                     <div class="flex items-center gap-1.5 px-2 py-1 rounded bg-slate-900 border border-slate-700 text-[10px] font-mono text-purple-300 obsidian-btn" title="Click to open tool">
                                        <i data-lucide="sparkles" class="w-3 h-3"></i> ${item.gem}
                                     </div>` : ''}
                                 </div>
                                 
                                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                     <div class="pl-2 border-l-2 border-slate-700">
                                         <div class="text-[10px] font-bold uppercase text-slate-500 mb-1">Target</div>
                                         <p class="text-slate-300 leading-snug">${item.userTask}</p>
                                     </div>
                                     <div class="pl-2 border-l-2 border-indigo-500/30 bg-indigo-900/10 rounded-r py-1 pr-2">
                                         <div class="text-[10px] font-bold uppercase text-indigo-400 mb-1 flex items-center gap-1"><i data-lucide="bot" class="w-3 h-3"></i> AI Support</div>
                                         <p class="text-slate-400 italic leading-snug">"${item.aiTask}"</p>
                                     </div>
                                 </div>
                             </div>
                         </div>
                    </div>`;
                });
            };

            renderSection("Morning Protocol", schedule.filter(i => i.id.includes('morning') || i.id === 'break-1'));
            renderSection("Core Work", schedule.filter(i => i.id.includes('main') || i.id === 'break-2'));
            renderSection("Growth & Assets", schedule.filter(i => i.id.includes('afternoon') || i.id === 'break-3'));
            renderSection("Night Ops", schedule.filter(i => i.id.includes('night')));

            taskList.innerHTML = html;
            lucide.createIcons();
        }

        // --- EFFECTS ---
        function initStarField() {
            const canvas = document.getElementById('star-canvas');
            const ctx = canvas.getContext('2d');
            let width, height, stars = [];
            const resize = () => { width = window.innerWidth; height = window.innerHeight; canvas.width = width; canvas.height = height; initStars(); };
            const initStars = () => { stars = Array(100).fill().map(() => ({ x: Math.random() * width, y: Math.random() * height, r: Math.random() * 1.5, a: Math.random(), s: Math.random() * 0.05 })); };
            const animate = () => {
                ctx.clearRect(0, 0, width, height);
                stars.forEach(star => {
                    ctx.beginPath(); ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${star.a})`; ctx.fill();
                    star.a += (Math.random() - 0.5) * 0.05; star.a = Math.max(0.1, Math.min(1, star.a));
                    star.y -= star.s; if(star.y < 0) star.y = height;
                });
                requestAnimationFrame(animate);
            };
            window.addEventListener('resize', resize); resize(); animate();
        }

        function triggerConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            const particles = Array(150).fill().map(() => ({ x: Math.random() * canvas.width, y: Math.random() * canvas.height - canvas.height, vx: Math.random() * 4 - 2, vy: Math.random() * 4 + 2, color: ['#22d3ee', '#34d399', '#a78bfa'][Math.floor(Math.random()*3)], size: Math.random() * 6 + 2 }));
            const animate = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = 0;
                particles.forEach(p => { p.x += p.vx; p.y += p.vy; if(p.y < canvas.height) { active++; ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, p.size, p.size); } });
                if(active > 0) requestAnimationFrame(animate);
            };
            animate();
        }

        init();
    </script>
</body>
</html>
